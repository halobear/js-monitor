!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("HaloMonitor",[],t):"object"==typeof exports?exports.HaloMonitor=t():e.HaloMonitor=t()}(this,(function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n,i={pid:"test",url:"",delay:2e3,needReport:function(){return!0}};!function(e){e[e.ERROR_RUNTIME=1]="ERROR_RUNTIME",e[e.ERROR_SCRIPT=2]="ERROR_SCRIPT",e[e.ERROR_STYLE=3]="ERROR_STYLE",e[e.ERROR_IMAGE=4]="ERROR_IMAGE",e[e.ERROR_AUDIO=5]="ERROR_AUDIO",e[e.ERROR_VIDEO=6]="ERROR_VIDEO",e[e.ERROR_CONSOLE=7]="ERROR_CONSOLE",e[e.ERROR_TRY_CATCH=8]="ERROR_TRY_CATCH"}(n||(n={}));var R,s={SCRIPT:n.ERROR_SCRIPT,LINK:n.ERROR_STYLE,IMG:n.ERROR_IMAGE,AUDIO:n.ERROR_AUDIO,VIDEO:n.ERROR_VIDEO},u=function(){function e(e){this.errors=[],this.lastReportTime=0,this.options=o(o({},i),e),this.init()}return e.prototype.init=function(){var e=this;console.log("初始化成功",this.options),window.addEventListener("error",(function(t){console.log("onerror触发");var r=t.target||{},o=r||{},i=(o.nodeName||"").toUpperCase();if(r!==window&&i&&i in s){var R=o,u={type:s[i],desc:R.baseURI+"@"+(R.src||R.href),stack:"no stack"};e.report(u)}else{var a=t.message,c=t.filename,f=t.lineno,l=t.colno,p=t.error;u={type:n.ERROR_RUNTIME,desc:a+" at "+c+":"+f+":"+l,stack:p&&p.stack?p.stack:"no-stack"};e.report(u)}})),window.addEventListener("unhandledrejection",(function(e){console.log(e)}),!0)},e.prototype.report=function(e){if(!this.errors.some((function(e){return e.desc}))){this.errors.push(e),this.errors=this.errors.slice(-10);var t=(new Date).getTime(),r=this.options.delay;t-(void 0===r?2e3:r)<this.lastReportTime||(this.lastReportTime=t,console.log("准备提交的内容",this.errors))}},e}();t.default=function(e){return R||(R=new u(e))}}]).default}));